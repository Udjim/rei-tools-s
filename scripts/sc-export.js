let a=false;(async()=>{let b=document.createElement("div");Object.assign(b.style,{position:"fixed",bottom:"20px",left:"20px",padding:"20px",backgroundColor:"rgba(0,0,0,0.8)",color:"white",fontSize:"20px",fontWeight:"bold",borderRadius:"10px",zIndex:"9999",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",cursor:"grab"});let c=document.createElement("div");c.textContent="Запуск...";let d=document.createElement("button");d.textContent="Прервать";Object.assign(d.style,{padding:"10px 20px",fontSize:"16px",cursor:"pointer"});d.onclick=()=>{a=true;c.textContent="Прерывание...";d.style.display="none"};b.appendChild(c);b.appendChild(d);document.body.appendChild(b);let e=false,f,g;b.addEventListener("mousedown",h=>{e=true;f=h.clientX-b.getBoundingClientRect().left;g=h.clientY-b.getBoundingClientRect().top;b.style.cursor="grabbing"});document.addEventListener("mousemove",h=>{if(e){b.style.left=h.clientX-f+"px";b.style.top=h.clientY-g+"px";b.style.bottom="auto"}});document.addEventListener("mouseup",()=>{if(e){e=false;b.style.cursor="grab"}});const w=(s,i=200,t=1e4)=>new Promise((r,j)=>{let n=Date.now();const m=setInterval(()=>{const x=document.querySelector(s);x?(clearInterval(m),r(x)):Date.now()-n>t?(clearInterval(m),j(new Error(`Время ожидания ${s} истекло`))):0},i)}),wb=(s,i=200,t=1e4)=>new Promise((r,j)=>{let n=Date.now();const m=setInterval(()=>{const x=Array.from(document.querySelectorAll("button")).find(y=>y.textContent.includes(s));x?(clearInterval(m),r(x)):Date.now()-n>t?(clearInterval(m),j(new Error(`Время ожидания кнопки с текстом "${s}" истекло`))):0},i)});const z=document.querySelector(".ReactVirtualized__Grid__innerScrollContainer");if(!z){c.textContent="Контейнер не найден!";return}const v=Array.from(z.querySelectorAll(":scope > div"));for(let i=0;i<v.length;i++){if(a){c.textContent="Процесс прерван!";break}const y=v[i];c.textContent=`Обработка ${i+1}/${v.length}`;const x=y.querySelector("div");if(x)x.click();else continue;try{(await w('[aria-label="export-to-button"]')).click()}catch{}try{(await wb("REISift")).click()}catch{}await new Promise(r=>setTimeout(r,450))}if(!a)c.textContent="Все элементы обработаны!"})();